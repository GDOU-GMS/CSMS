$.fn.toggles=function(a){a=a||{};var b=$.extend({drag:!0,click:!0,text:{on:"ON",off:"OFF"},on:!1,animate:250,transition:"ease-in-out",checkbox:null,clicker:null,width:50,height:20,type:"compact"},a),c="select"==b.type;b.checkbox=$(b.checkbox),b.clicker&&(b.clicker=$(b.clicker));var d="margin-left "+b.animate+"ms "+b.transition,e={"-webkit-transition":d,"-moz-transition":d,transition:d},f={"-webkit-transition":"","-moz-transition":"",transition:""},g=function(a,d,g,h){var i=a.toggleClass("active").hasClass("active");if(h!==i){var j=a.find(".toggle-inner").css(e);if(a.find(".toggle-off").toggleClass("active"),a.find(".toggle-on").toggleClass("active"),b.checkbox.prop("checked",i),!c){var k=i?0:-d+g;j.css("margin-left",k),setTimeout(function(){j.css(f),j.css("margin-left",k)},b.animate)}}};return this.each(function(){var a=$(this),d=a.height(),e=a.width();d&&e||(a.height(d=b.height),a.width(e=b.width));var f='<div class="toggle-',h=$(f+'slide">'),i=$(f+'inner">'),j=$(f+'on">'),k=$(f+'off">'),l=$(f+'blob">'),m=d/2,n=e-m;if(j.css({height:d,width:n,textAlign:"center",textIndent:c?"":-m,lineHeight:d+"px"}).html(b.text.on),k.css({height:d,width:n,marginLeft:c?"":-m,textAlign:"center",textIndent:c?"":m,lineHeight:d+"px"}).html(b.text.off).addClass("active"),l.css({height:d,width:d,marginLeft:-m}),i.css({width:2*e-d,marginLeft:c?0:-e+d}),c&&(h.addClass("toggle-select"),a.css("width",2*n),l.hide()),a.html(h.html(i.append(j,l,k))),h.on("toggle",function(b,c){b&&b.stopPropagation(),g(h,e,d),a.trigger("toggle",!c)}),a.on("toggleOn",function(){g(h,e,d,!1)}),a.on("toggleOff",function(){g(h,e,d,!0)}),b.on&&g(h,e,d),!b.click||b.clicker&&b.clicker.has(a).length||a.on("click",function(a){a.target==l[0]&&b.drag||h.trigger("toggle",h.hasClass("active"))}),b.clicker&&b.clicker.on("click",function(a){a.target==l[0]&&b.drag||h.trigger("toggle",h.hasClass("active"))}),b.drag&&!c){var o,p=(e-d)/4,q=function(c){a.off("mousemove"),h.off("mouseleave"),l.off("mouseup");var f=h.hasClass("active");return!o&&b.click&&"mouseleave"!==c.type?(h.trigger("toggle",f),void 0):(f?-p>o?h.trigger("toggle",f):i.animate({marginLeft:0},b.animate/2):o>p?h.trigger("toggle",f):i.animate({marginLeft:-e+d},b.animate/2),void 0)},r=-e+d;l.on("mousedown",function(b){o=0,l.off("mouseup"),h.off("mouseleave");var c=b.pageX;a.on("mousemove",l,function(a){o=a.pageX-c;var b;h.hasClass("active")?(b=o,o>0&&(b=0),r>o&&(b=r)):(b=o+r,0>o&&(b=r),o>-r&&(b=0)),i.css("margin-left",b)}),l.on("mouseup",q),h.on("mouseleave",q)})}})};